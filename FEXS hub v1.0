-- // Universal Hub (Fixed Tabs + Features + Side Toggle)
-- Put this in StarterGui > LocalScript

local Players = game:GetService("Players")
local TeleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")
local RunService = game:GetService("RunService")
local UIS = game:GetService("UserInputService")

local lp = Players.LocalPlayer

-- // ScreenGui
local gui = Instance.new("ScreenGui", game.CoreGui)
gui.Name = "UniversalHub"
gui.ResetOnSpawn = false

-- // Toggle Button (side of screen)
local ToggleBtn = Instance.new("TextButton", gui)
ToggleBtn.Size = UDim2.new(0,40,0,40)
ToggleBtn.Position = UDim2.new(0,10,0.5,-20)
ToggleBtn.Text = "â‰¡"
ToggleBtn.BackgroundColor3 = Color3.fromRGB(40,40,40)
ToggleBtn.TextColor3 = Color3.fromRGB(255,255,255)
ToggleBtn.Font = Enum.Font.GothamBold
ToggleBtn.TextSize = 18
ToggleBtn.AutoButtonColor = true

-- // Main Window
local Window = Instance.new("Frame", gui)
Window.Size = UDim2.new(0,500,0,320)
Window.Position = UDim2.new(0.5,-250,0.5,-160)
Window.BackgroundColor3 = Color3.fromRGB(25,25,25)
Window.Visible = true
Window.ClipsDescendants = true

local UICorner = Instance.new("UICorner", Window)
UICorner.CornerRadius = UDim.new(0,12)

-- // Tab buttons container
local TabBar = Instance.new("Frame", Window)
TabBar.Size = UDim2.new(1,0,0,30)
TabBar.BackgroundColor3 = Color3.fromRGB(35,35,35)

-- // Pages container
local Pages = Instance.new("Frame", Window)
Pages.Size = UDim2.new(1,0,1,-30)
Pages.Position = UDim2.new(0,0,0,30)
Pages.BackgroundTransparency = 0
Pages.BackgroundColor3 = Color3.fromRGB(40,40,40)

-- Utility
local Tabs = {}
local CurrentPage

local function MakeTab(name)
    local Btn = Instance.new("TextButton", TabBar)
    Btn.Size = UDim2.new(0,120,1,0)
    Btn.BackgroundColor3 = Color3.fromRGB(45,45,45)
    Btn.Text = name
    Btn.TextColor3 = Color3.fromRGB(200,200,200)
    Btn.Font = Enum.Font.Gotham
    Btn.TextSize = 14

    local Page = Instance.new("ScrollingFrame", Pages)
    Page.Size = UDim2.new(1,0,1,0)
    Page.Visible = false
    Page.BackgroundTransparency = 1
    Page.CanvasSize = UDim2.new(0,0,0,600)

    Btn.MouseButton1Click:Connect(function()
        if CurrentPage then CurrentPage.Visible = false end
        Page.Visible = true
        CurrentPage = Page
    end)

    if not CurrentPage then
        Page.Visible = true
        CurrentPage = Page
    end

    table.insert(Tabs,{Btn=Btn,Page=Page})
    return Page
end

local function AddButton(tab,text,callback)
    local Btn = Instance.new("TextButton", tab)
    Btn.Size = UDim2.new(1,-20,0,35)
    Btn.Position = UDim2.new(0,10,0,#tab:GetChildren()*40)
    Btn.Text = text
    Btn.BackgroundColor3 = Color3.fromRGB(60,60,60)
    Btn.TextColor3 = Color3.fromRGB(255,255,255)
    Btn.Font = Enum.Font.Gotham
    Btn.TextSize = 14
    Btn.MouseButton1Click:Connect(callback)
end

-- // Tabs
local MainTab = MakeTab("Main")
local PlayerTab = MakeTab("Player")
local VisualsTab = MakeTab("Visuals")

-- // Features
AddButton(MainTab,"Rejoin",function()
    TeleportService:Teleport(game.PlaceId,lp)
end)

AddButton(MainTab,"Server Hop",function()
    local servers = HttpService:JSONDecode(game:HttpGet(
        "https://games.roblox.com/v1/games/"..game.PlaceId.."/servers/Public?sortOrder=Asc&limit=100"
    ))
    for _,s in pairs(servers.data) do
        if s.playing < s.maxPlayers then
            TeleportService:TeleportToPlaceInstance(game.PlaceId,s.id,lp)
            break
        end
    end
end)

AddButton(PlayerTab,"Toggle Noclip",function()
    if _G.Noclip then
        _G.Noclip:Disconnect()
        _G.Noclip=nil
    else
        _G.Noclip=RunService.Stepped:Connect(function()
            if lp.Character then
                for _,v in pairs(lp.Character:GetDescendants()) do
                    if v:IsA("BasePart") then v.CanCollide=false end
                end
            end
        end)
    end
end)

AddButton(PlayerTab,"Fly (toggle)",function()
    _G.Flying = not _G.Flying
    local char = lp.Character or lp.CharacterAdded:Wait()
    local hrp = char:WaitForChild("HumanoidRootPart")
    local hum = char:WaitForChild("Humanoid")

    if _G.Flying then
        local bg = Instance.new("BodyGyro",hrp)
        local bv = Instance.new("BodyVelocity",hrp)
        bg.MaxTorque = Vector3.new(9e9,9e9,9e9)
        bv.MaxForce = Vector3.new(9e9,9e9,9e9)

        _G.FlyLoop = RunService.RenderStepped:Connect(function()
            if not _G.Flying then bg:Destroy() bv:Destroy() _G.FlyLoop:Disconnect() return end
            local move = hum.MoveDirection
            bv.Velocity = Vector3.new(move.X*50,
                (UIS:IsKeyDown(Enum.KeyCode.Space) and 50 or (UIS:IsKeyDown(Enum.KeyCode.LeftControl) and -50 or 0)),
                move.Z*50)
        end)
    end
end)

AddButton(PlayerTab,"WalkSpeed 50",function()
    if lp.Character and lp.Character:FindFirstChildOfClass("Humanoid") then
        lp.Character:FindFirstChildOfClass("Humanoid").WalkSpeed=50
    end
end)

AddButton(PlayerTab,"JumpPower 100",function()
    if lp.Character and lp.Character:FindFirstChildOfClass("Humanoid") then
        lp.Character:FindFirstChildOfClass("Humanoid").JumpPower=100
    end
end)

AddButton(VisualsTab,"ESP (Chams + Name)",function()
    _G.ESP = not _G.ESP
    for _,plr in pairs(Players:GetPlayers()) do
        if plr~=lp and plr.Character then
            if _G.ESP then
                local hl = Instance.new("Highlight",plr.Character)
                hl.FillTransparency=0.8
                hl.OutlineColor=Color3.fromRGB(0,255,0)
                hl.DepthMode=Enum.HighlightDepthMode.AlwaysOnTop

                local head=plr.Character:FindFirstChild("Head")
                if head and not head:FindFirstChild("ESPTag") then
                    local bb=Instance.new("BillboardGui",head)
                    bb.Name="ESPTag"
                    bb.Size=UDim2.new(0,100,0,20)
                    bb.AlwaysOnTop=true
                    bb.StudsOffset=Vector3.new(0,2,0)
                    local lbl=Instance.new("TextLabel",bb)
                    lbl.Size=UDim2.new(1,0,1,0)
                    lbl.BackgroundTransparency=1
                    lbl.Text=plr.Name
                    lbl.TextSize=12
                    lbl.Font=Enum.Font.GothamBold
                    lbl.TextColor3=Color3.fromRGB(0,255,0)
                end
            else
                if plr.Character:FindFirstChildOfClass("Highlight") then plr.Character:FindFirstChildOfClass("Highlight"):Destroy() end
                if plr.Character:FindFirstChild("Head") and plr.Character.Head:FindFirstChild("ESPTag") then
                    plr.Character.Head.ESPTag:Destroy()
                end
            end
        end
    end
end)

-- // Toggle open/close
local open = true
ToggleBtn.MouseButton1Click:Connect(function()
    open = not open
    Window.Visible = open
end)
